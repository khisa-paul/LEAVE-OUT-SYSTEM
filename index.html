<!DOCTYPE html>
<html>
<head>
  <title>Friends School Kimugui Girls - Leave Out System</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    header, footer {
      background-color: #003366;
      color: white;
      text-align: center;
      padding: 10px 0;
    }
    .container {
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
      box-sizing: border-box;
    }
    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-top: 10px;
    }
    button {
      flex: 1;
      min-width: 70px;
      padding: 6px;
      font-size: 12px;
      border: none;
      color: white;
      cursor: pointer;
      border-radius: 4px;
    }
    .sms-btn { background-color: #4CAF50; }
    .print-btn { background-color: #2196F3; }
    .download-btn { background-color: #f57c00; }
    .save-btn { background-color: #9c27b0; }
    .logout-btn { background-color: #e91e63; }
    .search-container {
      margin-bottom: 15px;
      display: flex;
      gap: 5px;
    }
    .search-container input[type="text"] {
      flex: 1;
    }
    @media (max-width: 480px) {
      .button-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

  <header>
    <h2>FRIENDS SCHOOL KIMUGUI GIRLS</h2>
    <p>MOTTO: STRIVE TO EXCEL</p>
  </header>

  <div class="container">
    <div class="search-container">
      <input type="text" id="searchAdm" placeholder="Enter Admission Number">
      <button onclick="searchStudent()" style="background-color: #607d8b;">Search</button>
    </div>

    <input type="text" id="studentName" placeholder="Student Name">
    <input type="text" id="admNo" placeholder="Admission Number">
    <input type="text" id="form" placeholder="Form">
    <input type="text" id="reason" placeholder="Reason">
    <input type="text" id="date" placeholder="Date">
    <input type="text" id="parentContact" placeholder="Parent Contact">
    <input type="text" id="principalContact" placeholder="Principal Contact">
    <input type="text" id="modName" placeholder="MOD Name">

    <div class="button-row">
      <button class="sms-btn" onclick="sendSMS()">Send SMS</button>
      <button class="print-btn" onclick="printSheet()">Print</button>
      <button class="download-btn" onclick="downloadPDF()">Download</button>
      <button class="save-btn" onclick="saveData()">Save</button>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
  </div>

  <footer>
    SYSTEM BY PAUL MAKOKHA, TO GOD BE THE GLORY, 0708458844 / 0756157756
  </footer>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxqVnXsUtfKWXJ5bA_rq54eJqmiUJ4ZBDmb4KWtqJOm3d-1qCm-0RedfWfoezYghFrrTw/exec";

    function getFormData() {
      return {
        studentName: document.getElementById("studentName").value,
        admNo: document.getElementById("admNo").value,
        form: document.getElementById("form").value,
        reason: document.getElementById("reason").value,
        date: document.getElementById("date").value,
        parentContact: document.getElementById("parentContact").value,
        principalContact: document.getElementById("principalContact").value,
        modName: document.getElementById("modName").value,
      };
    }

    function saveData() {
      const data = getFormData();
      data.type = "save";

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data),
      })
      .then(res => res.json())
      .then(response => {
        alert("Saved successfully!");
        clearForm();
      })
      .catch(err => console.error(err));
    }

    function clearForm() {
      document.querySelectorAll("input[type=text]").forEach(input => input.value = "");
    }

    function sendSMS() {
      const data = getFormData();
      data.type = "sms";

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data),
      })
      .then(res => res.json())
      .then(response => alert("SMS Sent!"))
      .catch(err => console.error(err));
    }

    function printSheet() {
      const data = getFormData();
      data.type = "print";

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data),
      })
      .then(res => res.json())
      .then(response => {
        if (response.url) {
          window.open(response.url, "_blank");
        } else {
          alert("Printed, but no PDF link received.");
        }
      })
      .catch(err => console.error(err));
    }

    function downloadPDF() {
      alert("Use the print button to generate and download the PDF.");
    }

    function searchStudent() {
      const admNo = document.getElementById("searchAdm").value;
      if (!admNo) {
        alert("Enter admission number to search!");
        return;
      }

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ type: "search", ADM_NO: admNo }),
      })
      .then(res => res.json())
      .then(data => {
        if (data && data.studentName) {
          document.getElementById("studentName").value = data.studentName;
          document.getElementById("admNo").value = data.admNo;
          document.getElementById("form").value = data.form;
          document.getElementById("reason").value = data.reason;
          document.getElementById("date").value = data.date;
          document.getElementById("parentContact").value = data.parentContact;
          document.getElementById("principalContact").value = data.principalContact;
          document.getElementById("modName").value = data.modName;
        } else {
          alert("Student not found!");
        }
      })
      .catch(err => console.error(err));
    }

    function logout() {
      alert("Logged out!");
      clearForm();
    }
  </script>
</body>
</html>

     
     
 
      
     
      
   


    
  
     



      
     
